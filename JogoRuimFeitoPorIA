local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local CheckShotRemote = LocalPlayer.ClientRemotes:FindFirstChild("CheckShot")

if not CheckShotRemote then
    warn("Remote não encontrado.")
end

local DELAY = 0.05
local isFiring = false

local BASE_ARGS = {
    [1] = 0,
    [2] = 0,
    [3] = 1,
    [4] = 0.8,
    [5] = CFrame.new(-41.539764404296875, 9.525708198547363, -491.22882080078125) * CFrame.Angles(-0.04637043550610542, 0.1005464494228363, 0.00465783616527915),
    [6] = Vector3.new(-42.78217697143555, 8.94626522064209, -503.530517578125),
    [7] = nil, 
    [8] = 6386, 
    [9] = 0 
}

local function forceHit()
    isFiring = true
    print("Iniciando loop.")
    
    while isFiring do
        local targets = {}
        
        for _, player in Players:GetPlayers() do
            if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
                table.insert(targets, player.Character.Head)
            end
        end

        for _, targetHead in ipairs(targets) do
            if not isFiring then break end
            
            BASE_ARGS[7] = targetHead
            BASE_ARGS[9] = tick()
            
            pcall(function()
                if CheckShotRemote then
                    CheckShotRemote:FireServer(unpack(BASE_ARGS))
                end
            end)
            
            task.wait(DELAY / math.max(#targets, 1)) 
        end
        
        if #targets == 0 then
            task.wait(DELAY)
        end
    end
    print("Loop interrompido.")
end

local gui = Instance.new("ScreenGui", game.CoreGui)
gui.ResetOnSpawn = false

local button = Instance.new("ImageButton")
button.Name = "Toggle"
button.Size = UDim2.new(0, 62, 0, 62)
button.Position = UDim2.new(1, -200, 1, -60)
button.AnchorPoint = Vector2.new(0, 0)
button.BackgroundTransparency = 0.2
button.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
button.Image = "rbxassetid://91045108512308"
button.ImageColor3 = Color3.fromRGB(255, 255, 255)
button.BorderSizePixel = 2
button.BorderColor3 = Color3.fromRGB(255, 0, 0)
button.ZIndex = 1000
button.Parent = gui

local textLabel = Instance.new("TextLabel")
textLabel.Size = UDim2.new(0, 180, 0, 48)
textLabel.Position = UDim2.new(0, 65, 0, 7)
textLabel.BackgroundTransparency = 1
textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
textLabel.Font = Enum.Font.SourceSansBold
textLabel.TextSize = 20
textLabel.TextXAlignment = Enum.TextXAlignment.Left
textLabel.Text = "hitleréinocente: OFF"
textLabel.ZIndex = 1000
textLabel.Parent = button

local dragging, dragInput, dragStart, startPos = false
button.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = button.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)
button.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)
UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		button.Position = UDim2.new(
			startPos.X.Scale,
			startPos.X.Offset + delta.X,
			startPos.Y.Scale,
			startPos.Y.Offset + delta.Y
		)
	end
end)

button.MouseButton1Click:Connect(function()
	isFiring = not isFiring

	if isFiring then
		textLabel.Text = "tomaOn"
		textLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
        button.BorderColor3 = Color3.fromRGB(0, 255, 0)
		task.spawn(forceHit)
		warn("✅ Ativado")
	else
		textLabel.Text = "tomaOff"
		textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
        button.BorderColor3 = Color3.fromRGB(255, 0, 0)
		warn("⛔ Desativado")
	end
end)

print("Script carregado. Pronto para ser ativado.")
